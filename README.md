# Type-Safe Fetch

Given a **path** and a **method**, the TypeScript compiler will **guarantee** that you are passing the correct **path** and **query** parameters, and the correct **body** (and only if needed).

Realised already how insanely awesome that is? The compiler will validate **every** aspect of the API request, including the response type - automatically!

*Bonus: Tiny library (~1kb) with 0 dependencies.*

> Warning! This is alpha software and will very likely still change significantly before the 1.0.0 release - use only to test the capabilities and suggest improvements.

## Demo

> Using typesafe-fetch with the Petstore demo API in VS Code to see the compiler suggested completions.

[![Screen capture](https://media.giphy.com/media/M3HnoezzZ3s7ESdiFD/giphy.gif)](https://giphy.com/gifs/M3HnoezzZ3s7ESdiFD)
## Usage

Install:
```
npm install typesafe-fetch

yarn add typesafe-fetch
```

Setup:

```ts
import getSafeFetch from 'typesafe-fetch';

// See below how to generate the API definitions
import { paths as ApiDefinition } from "./petstore";

// Now set up using your existing OpenAPI definition
const safeFetch = getSafeFetch<ApiDefinition>({
  fetch, // define which fetch function to use
});

// Make API calls :)
const res = safeFetch('/endpoint', {
  query: {
    sampleParam: 123,
  },
});
```

### Using with multiple APIs

You can use union types to combine multiple APIs into one (assuming the endpoints are different and the base URL is the same, otherwise just use different instances of `safeFetch`)

```ts
import { paths as SomeApiDefinition } from "./some-api";
import { paths as SomeOtherApiDefinition } from "./some-other-api";

const safeFetch = getSafeFetch<SomeApiDefinition & SomeOtherApiDefinition>({
  fetch,
});
```

## Generating the API definitions

This library relies on the TS models generated by [OpenAPI-TypeScript](https://github.com/drwpow/openapi-typescript)

For the simplest way to generate the models run:

```
npx openapi-typescript https://petstore.swagger.io/v2/swagger.json --output schema.ts
```

Check out their docs for more advanced use-cases.

## Roadmap to v1

- [ ] Figure out a way to make it more generic, so that it could be used with any fetching library (e.g. axios)